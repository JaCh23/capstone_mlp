
#include <math.h>
#include <iostream>

#define NUM_INPUTS 24
#define NUM_HIDDEN 32
#define NUM_OUTPUTS 4
#define INPUT_SAMPLES 5
#define TOTAL_SAMPLES 10

double sigmoid(double x) {
    return 1.0 / (1.0 + exp(-x));
}

int mlp(double inputs[NUM_INPUTS]) {

	double hidden_layer1[NUM_HIDDEN];
	double hidden_layer2[NUM_HIDDEN];
	double outputs[NUM_OUTPUTS];
	double softmax_outputs[NUM_OUTPUTS];

    // Initialize weights and biases for the hidden layers and output layer
	double weights_hidden_layer1[NUM_INPUTS][NUM_HIDDEN] = {
    {0.102506444, 0.19679374, 0.09388371, -0.27791741, 0.014275927, 0.09055922, -0.19166091, -0.12475899, -0.11866661, 0.0035446535, -0.22332294, 0.026845362, 0.19756798, -0.19461705, 0.048656672, -0.1615423, -0.013381894, -0.08020575, -0.11188429, 0.2842856, 0.13158199, -0.0945655, 0.26772913, -0.3217155, -0.13399146, -0.44791624, -0.18074208, -0.16889556, 0.10759155, 0.026166383, -0.06458419, 0.24923758},
    {-0.2665156, 0.30975142, -0.1413549, 0.15142308, 0.030938232, 0.2867001, 0.07344633, 0.07336312, 0.01463095, -0.25857252, -0.1184925, 0.044287305, 0.06804239, 0.19482358, 0.1981561, 0.073036976, 0.17186864, 0.18375373, -0.09845478, -0.029680347, 0.14575331, 0.2553437, -0.15623432, 0.032767206, -0.25420842, 0.020062905, 0.13073625, -0.17363077, 0.17248121, -0.1512221, 0.15193418, -0.33138883},
    {0.14552307, -0.21786562, 0.12463357, 0.15813585, -0.0550991, -0.09635046, -0.108412646, 0.16883053, 0.2738088, 0.20038947, -0.1913683, 0.0846214, -0.2001834, 0.06629176, 0.13253263, -0.0907672, 0.06211677, -0.09223778, 0.07131771, 0.1280911, 0.04179824, 0.019169893, 0.021873139, 0.19481799, 0.22136272, -0.21130015, -0.12436906, -0.0647516, -0.09833081, -0.38187903, -0.24827795, 0.057057966},
    {-0.19899654, -0.008622881, 1.2741185, -0.5244305, 0.8516439, 0.9245309, -0.5643308, -0.45931086, -0.74341846, 0.10721048, 1.0763078, -0.890524, -0.20363176, 0.05767691, -0.07327667, -0.6489774, -1.3192891, -0.7168936, -0.2950805, 0.88425756, -0.3018096, -1.0683919, -0.99520624, -0.6960072, 0.66911536, -0.5188506, -0.7181466, -0.6594334, 0.8331006, -0.77672255, 0.8353853, -1.223027},
    {-0.24421348, -0.062127165, 0.8194217, -0.72352654, 0.74057925, 0.7205271, -0.67281616, -0.5801843, -0.30092973, 0.5388256, 0.49684352, -1.1292006, -0.55260026, 0.18170819, -0.38687414, -0.67815304, -0.93843406, -0.83248675, -0.5134473, 0.8785318, -0.2388256, -0.5585013, -0.99781746, -0.9621098, 1.0338519, -0.6706649, -0.39825273, -0.26839226, 0.890334, -0.933058, 0.7832101, -0.7888913},
    {-0.64786124, -0.106584094, 0.99199355, 0.10498232, 0.03939685, 0.91632485, -0.42037547, -0.20893893, -0.2797113, 0.3497577, 0.8681236, -0.8938508, -0.63338053, -0.22329518, -0.13186531, -0.23461264, -0.94645894, -0.9382441, -0.501634, 0.69672835, -0.2842357, -0.5175882, -0.41990945, -0.6358922, 0.56588584, -0.70687634, -0.306027, -0.15193155, 0.5721073, -0.76762205, 1.0785055, -1.0875176},
    {-0.39525902, -0.5838749, 0.79024893, -0.5525751, 0.76892823, 0.96691465, -0.8647856, -0.852433, -0.9416453, 0.8051581, 0.8290286, -0.32755232, -0.816925, 1.3085899, -0.68481016, -1.1063724, -0.5169689, -0.739627, -0.7439368, 0.6798023, -0.6714025, -0.8142192, -0.9447624, -0.22726609, 0.66822284, -0.99887913, -1.0044911, -0.7318969, 1.1410773, -0.84070635, 1.152088, -0.8077505},
    {-0.27913713, -0.38881427, 1.0096613, -0.40261224, 0.31994277, 1.0688084, -0.1894585, -0.49933735, -0.8480709, 0.17164218, 0.8776487, -0.6440647, -0.6688339, 0.2849971, -0.13711344, -0.05728297, -0.8147335, -0.94516516, -0.16459183, 1.1443729, -0.17404942, -0.4022853, -0.91652256, -0.6044012, 0.8969147, -0.9447877, -0.82024205, -0.63277596, 0.21550716, -0.8310393, 0.7513234, -0.63118786},
    {-0.6684528, -0.22498961, 1.2534547, -0.2894957, 0.76147646, 0.7272446, -0.59233975, -0.37004432, -0.33575773, 0.26568595, 0.5988924, -1.3180345, -0.5238292, 0.22089009, -0.2582777, -0.56251645, -1.0661917, -0.93473095, -0.7065472, 0.8682454, -0.49448287, -1.0226563, -0.40893304, -0.7311624, 1.0023975, -0.41482905, -0.81714815, -0.59953636, 0.39068165, -0.36134118, 1.1129256, -0.87706244},
    {0.1808185, 0.1329435, 0.10466498, 0.22465587, -0.34233728, 0.040151015, -0.14225557, 0.010763816, -0.38687688, 0.028772874, -0.15260577, 0.12834245, 0.27535218, 0.106236205, 0.14415568, 0.32860705, -0.10854295, 0.2369685, 0.14811829, -0.14875813, -0.21312898, -0.09478932, -0.07082566, 0.28085947, -0.26822516, -0.09116604, -0.18856099, -0.062150918, 0.09465815, -0.07123574, 0.26125598, 0.08590892},
    {0.17900555, -0.015687402, -0.24801572, -0.1005235, 0.25233987, -0.075735666, -0.023311151, 0.076262325, -0.16658868, 0.2820086, -0.29015422, -0.101991124, 0.113547884, 0.17994261, -0.16316336, -0.22766514, 0.15038563, 0.09578551, -0.08604102, 0.23378658, -0.1730547, 0.026160417, -0.05610443, -0.23701598, 0.1295235, 0.20408039, 0.18491851, 0.17651208, -0.2929638, -0.19238055, -0.009456886, -0.12985452},
    {-0.13702074, -0.3412915, 0.040467355, 0.30360198, 0.21251728, 0.020899769, -0.08132267, -0.19592251, -0.3084569, -0.0022772104, 0.16147122, -0.101029634, -0.07209299, 0.13584799, 0.16119294, -0.07758242, -0.19763212, -0.019848704, 0.11503676, 0.11135425, -0.16953893, -0.10995763, -0.2713146, 0.29912698, 0.0073390347, -0.32371172, 0.12686433, 0.1980999, 0.016953738, 0.08720693, 0.25075537, 0.15605427},
    {-0.66197366, -1.192832, -1.6787636, -1.4433424, 1.2970586, -1.6279413, -0.8990244, -0.820978, -0.20506428, 1.4045984, 0.820409, 1.0514147, -0.9214104, 1.2132777, -1.4262, -1.3489797, 1.692632, 1.429422, -0.88872445, -1.5625986, -0.7924415, 1.3762112, -0.54710263, 0.6782512, -1.0127076, 0.33853844, -1.3506942, -1.1734143, 1.0875429, 1.2493799, -1.184067, 1.5507863},
    {0.8542402, 1.2687898, 0.7595645, 1.5626596, -1.1490188, 0.51719964, 1.8145285, 1.5382441, 0.9431083, -1.4619128, -0.84681714, -1.0673739, 1.1455021, -1.4288728, 1.436607, 1.3366506, -0.9387827, -1.145504, 1.7783042, 0.406605, 0.5433067, 0.1719619, 0.9328734, -1.3594977, 1.1802031, 1.4733639, 1.2280173, 1.632621, -1.3181763, 1.3180032, -0.22571862, -0.7596238},
    {0.07120271, 0.5139179, 0.40845877, 0.6801482, -0.14002262, 0.4391793, 0.5126074, 0.37335694, 0.21042618, -0.8161173, 0.005943901, -0.51023537, 0.53426075, -0.67088014, 0.49983147, 0.73525554, -0.48137283, -0.35543457, 0.5774257, 0.25091732, -0.091117, 0.28783095, 0.5416319, -0.15271804, 0.45743018, 0.6259372, -0.005303966, 0.64413, -0.20461361, 0.396173, -0.04755473, -0.5375679},
    {-0.25527686, -0.0911499, 0.23503739, -0.0835624, -0.15521082, 0.27522495, 0.014721202, 0.2699834, 0.10537848, 0.018536417, -0.1434441, -0.03204191, -0.17637691, -0.37667423, 0.007714499, 0.114485756, -0.0074342205, -0.2585412, 0.2195136, 0.033437796, 0.09690255, 0.10447053, 0.27667648, 0.092317395, -0.16155812, 0.16373815, 0.24124508, 0.05444763, -0.35165104, -0.14234142, 0.12793262, -0.30514237},
    {-0.060562175, 0.05635841, -0.2692716, -0.10865588, 0.042530112, 0.019988447, 0.11675478, -0.015785005, -0.07690929, 0.15338635, 0.03588413, 0.08405324, 0.03061979, -0.065271534, -0.07503213, -0.2930442, -0.12505504, -0.07942736, -0.09271432, 0.18069455, 0.19469455, -0.3766855, -0.12453914, -0.06498344, -0.18188363, 0.02202752, 0.14068325, -0.12838742, 0.0113423085, -0.29560837, 0.44560274, 0.08873682},
    {0.11637604, -0.21699251, 0.08841103, 0.26698694, -0.17585097, -0.18719147, 0.18637393, -0.108520925, 0.23805562, 0.04732759, 0.29235387, 0.057383887, -0.21635498, 0.14044967, 0.26798522, 0.26988938, -0.22026935, -0.13370937, -0.065092616, 0.1606159, 0.0642526, -0.14344805, -0.17079571, 0.21273264, 0.1635211, -0.015160173, -0.22761676, -0.10964341, -0.079538226, -0.14174877, -0.21912535, 0.2389286},
    {0.08066066, 0.27635816, 0.1335807, -0.12561868, -0.063274026, -0.119129635, -0.13192691, -0.15303919, -0.2513267, -0.09749772, -0.14314145, 0.17270738, 0.1223401, -0.07869761, -0.3128822, 0.08916396, 0.009814074, 0.29176912, 0.09811029, -0.1941732, 0.20225722, -0.3013201, 0.19095951, -0.092451826, 0.16284965, 0.01194763, 0.1787076, 0.14997195, -0.20766574, -0.5403578, -0.18879788, 0.13550866},
    {-0.121606655, -0.17050931, 0.09416236, -0.15626967, 0.103276715, 0.21163702, 0.19238171, 0.2746232, 0.07374845, 0.29114747, -0.2992018, -0.21875417, 0.26503366, -0.04308313, 0.113872364, -0.041686792, 0.12708874, -0.23072882, 0.090890646, -0.028970394, -0.0126313595, -0.27095535, 0.29366633, -0.07518008, -0.32533684, -0.38799042, 0.29350683, 0.17850822, 0.0375263, 0.18124393, -0.14041367, -0.18527456},
    {-0.12378088, -0.2884074, -0.14290306, -0.20616335, -0.30489507, -0.16774271, -0.2955518, -0.10341102, -0.07296027, -0.11801288, 0.2894432, 0.0847755, -0.21264097, 0.2779268, 0.2928864, -0.23565273, -0.21448848, 0.37727168, -0.32274887, -0.01976341, 0.011141861, -0.24276836, -0.31838092, 0.12316249, 0.106011964, -0.2809523, 0.13288783, 0.2002425, -0.023743466, -0.44548538, -0.23312148, 0.06439112},
    {0.1979893, 0.07505889, -0.21613234, 0.105790146, 0.18792987, 0.005407321, 0.16119057, -0.20989127, 0.16764246, -0.12172362, -0.29465428, 0.1850736, -0.2609734, -0.05960554, -0.25286037, 0.28651774, -0.2904201, -0.09646287, -0.30781975, -0.1486511, 0.14704458, -0.02714182, 0.34897256, 0.0828872, 0.05397162, -0.22224222, 0.19226891, -0.2514617, -0.053579513, -0.09669245, -0.13407134, -0.15615135},
    {-0.12330874, 0.21292737, 0.306227, 0.23391497, -0.29349813, -0.10102286, 0.06943867, -0.22395438, 0.28175366, -0.18595585, -0.19255443, 0.12131362, 0.07863719, -0.17664175, -0.10617377, -0.19492438, 0.18437484, -0.22494839, -0.07084711, -0.25941285, -0.07289322, -0.16678333, 0.12397306, 0.14883348, -0.19889526, 0.14632799, 0.02202702, 0.29181513, -0.18864433, -0.28927872, 0.016746512, 0.0918228},
    {-0.23012866, -0.18171789, -0.11088519, 0.010517198, 0.14109164, 0.17386827, 0.21116804, 0.23143223, 0.1154031, -0.27907172, 0.023949632, 0.17346802, -0.2020114, -0.0280917, -0.1591582, 0.23387133, 0.29836497, -0.24552652, 0.24958369, 0.21733631, -0.026773944, 0.2107813, -0.0322376, 0.0769492, -0.039669488, 0.1025366, 0.26907697, -0.15929432, 0.1484137, 0.21389166, 0.34611613, -0.12433043},
};

	double biases_hidden_layer1[NUM_HIDDEN] = {0.011167158, -0.006104761, -0.022455702, 0.027181897, -0.067718424, -0.0030990578, 0.040471163, 0.07839734, -0.045371804, 0.02034645, 0.011745748, -0.02481677, 0.03198716, -0.0895336, 0.016013822, 0.0057438915, 0.012460168, 0.050369933, -0.04204313, 0.0071548237, -0.031845447, -0.034943763, 0.04203395, -0.04981614, -0.043023717, -0.15162285, 0.04088243, 0.026818145, -0.03802696, -0.112104915, 0.057722606, -0.06404709};

	double weights_hidden_layer2[NUM_HIDDEN][NUM_HIDDEN] = {
    {-0.38933155, -0.14922626, 0.45256063, -0.060912367, 0.0014783795, 0.26825917, 0.2529068, -0.1881813, -0.44911337, 0.4474404, 0.37750497, -0.43330118, -0.469768, 0.33481005, 0.33195034, 0.22850427, -0.04385475, -0.18467198, 0.30567372, -0.12517092, -0.19726653, 0.12971576, -0.20972355, -0.39465338, 0.3548686, -0.45601693, 0.15249895, -0.29043204, -0.13728665, -0.4769176, 0.32102352, -0.4601069},
    {-0.44902545, -0.25492203, 0.017734779, 0.44848734, 0.15258045, 0.44033903, 0.088873275, -0.31088632, -0.55517006, 0.2531281, 0.5591271, -0.39797613, -0.22148177, 0.2083227, 0.19094005, 0.53324264, 0.51687706, -0.5720105, 0.19359499, -0.6392631, -0.57729065, 0.24236119, 0.26555136, -0.47776946, 0.16739325, -0.49520537, -0.12231774, -0.34869692, -0.61934143, -0.42943403, 0.5593826, -0.32128596},
    {0.48422274, -0.6641449, -0.49601924, -0.16801538, 0.610325, -0.053903554, -0.36247522, -0.29690123, -0.54228854, 0.6994591, 0.54856354, -0.16322765, 0.33022696, -0.4305902, -0.14569625, 1.0009061, 0.51348025, -0.01650257, 0.16712347, -1.1568978, -0.052987088, 0.89316386, 0.8951204, -0.49978587, -0.29325384, 0.09296231, -0.80851007, -0.07851867, -0.7394838, -0.47320765, 0.5360368, -0.5222841},
    {-0.073237166, -0.70870835, 0.42946464, 0.44580215, 0.36991024, 0.7760212, 0.014433695, -0.73199654, -0.39264, 0.4125599, 0.35178202, -0.80692947, -0.110902905, 0.7441596, 0.5071804, 0.46372885, 0.7990621, -0.7473076, 0.36944175, -0.23667775, -0.733888, 0.42294243, 0.71807915, -0.39437416, 0.11447707, -0.94265175, -0.13720438, 0.16195676, -0.22167403, -0.9752629, 0.5479659, -0.15769774},
    {0.32049033, 0.6303322, -0.76363057, -0.40784264, -0.26968133, -0.8040845, -0.09475899, 0.4521399, 0.69993025, 0.070747174, -0.15375853, 0.4540304, 0.09154086, -0.55218464, -0.48049024, -0.39986303, -0.3698877, 0.6834657, -0.42659354, 0.15530406, 0.5733521, 0.18436517, -0.2801355, 0.76489544, -0.11869608, 0.7576182, -0.1931717, 0.34030893, 0.48944727, 0.6299442, -0.38887772, 0.69215685},
    {0.32263848, -0.39789802, -0.36924472, -0.22349441, 1.0562607, -0.08430745, -0.74121857, -0.2263851, -0.2635578, 0.98347783, 0.6052604, -0.26593468, 0.6967585, -0.58065236, -0.24226739, 0.6556888, 0.776889, 0.014590637, 0.3118655, -0.9315268, 0.13937004, 0.5343057, 0.94484586, -0.3717358, 0.044942696, -0.22550534, -0.9220548, -0.17351168, -0.74567074, -0.5704408, 0.5970747, -0.363675},
    {-0.15016888, -0.779118, 0.36027014, 0.59473306, -0.15746194, 0.50881237, 0.16213174, -0.5045577, -0.45786405, 0.27001137, 0.5230878, -0.8081116, -0.52457654, 0.7882429, 0.63477063, 0.21593733, 0.5812247, -0.09937825, 0.47303888, -0.31168815, -0.5031222, -0.00084597396, 0.11959874, -0.018768331, -0.03934424, -0.81888026, 0.00068525993, 0.15546517, 0.166829, -0.6291969, 0.8141131, -0.1629306},
    {-0.15816149, -0.4139387, 0.56394047, 0.461757, 0.021343172, 0.766074, 0.30113983, -0.5566867, -0.45668992, 0.61324483, 0.5655362, -0.7668982, -0.59843516, 0.8311633, 0.13121037, 0.34810233, 0.42171082, -0.6284325, 0.52280617, 0.15456761, -0.79515785, 0.23192273, 0.114740245, -0.07157607, 0.38096055, -0.6742982, 0.17207836, 0.28050402, -0.051906977, -0.8061241, 0.3717827, -0.4353422},
    {-0.27233043, -0.090223484, 0.2723549, 0.309536, -0.16723756, -0.02429626, 0.50551414, -0.04050258, -0.4065661, 0.14813606, 0.13865156, -0.34048852, -0.37953284, 0.17111476, 0.3893529, -0.12684382, -0.03158876, -0.034799382, 0.29253948, 0.06188636, -0.22982074, 0.07158553, -0.3284398, -0.042192016, -0.10371602, -0.05425957, 0.3840895, -0.0363326, 0.2885586, -0.36612168, 0.024353627, -0.1932278},
    {0.4754859, 0.90117925, -0.64203906, -1.0355357, -0.29808453, -0.50084907, 0.060739096, 0.6724055, 0.6608994, -0.31431317, -0.77035415, 0.73648816, 0.016639825, -0.39058295, -0.21250033, -0.6588702, -0.48042357, 0.7529638, -0.4305206, 0.38379174, 0.9226499, -0.30174243, -0.7813061, 0.5555994, -0.3051531, 0.728266, 0.10323804, 0.12309124, 0.40797964, 0.57843685, -0.89333093, 0.69504577},
    {0.29459828, 0.56988776, -0.70239204, -0.6100898, 0.47631228, -0.7948642, -0.6362279, 0.4472288, 0.38689283, -0.12235656, 0.14214613, 0.08852408, 0.59539217, -0.70269275, -0.36635464, -0.03396036, -0.10720846, 0.21828651, 0.013138419, 0.10221477, 0.50015897, 0.18534319, 0.20786548, 0.64352363, -0.7244531, 0.48178637, -0.4151424, 0.3329745, -0.14980392, 0.84951764, -0.4627007, 0.4628792},
    {0.19553185, 0.47666445, -0.05850718, -0.05350524, -0.780695, 0.018500505, 0.29502586, 0.14381959, 0.44848794, -0.2725392, -0.39223185, 0.4975799, -0.6968317, 0.32705003, 0.22587156, -0.66048634, -0.5577469, -0.019492347, -0.18198852, 0.5259589, 0.5402247, -0.66586536, -0.7508462, 0.5388303, 0.37277746, 0.36996618, 0.60555327, 0.1899856, 0.34044492, 0.20814928, -0.40840232, 0.3442881},
    {-0.04939302, -0.3277427, 0.54404825, 0.5593188, 0.06934878, 0.65951836, 0.28363666, -0.059098013, -0.64116496, 0.27009302, 0.3639225, -0.57114434, -0.13474111, 0.70219207, 0.4544247, 0.29814827, 0.23658064, -0.62161607, -0.10542527, 0.05192711, -0.6336585, -0.08968121, -0.07676843, -0.41333744, 0.24231866, -0.49801394, 0.11565876, 0.02620333, -0.30268317, -0.5792842, 0.245568, -0.085778855},
    {0.0757378, 0.6979012, -0.28393784, -0.5782286, -0.007577535, -0.73479956, -0.097580455, 0.41850442, 0.47720483, -0.40107664, -0.4975641, 0.6487581, 0.25226507, 0.010895139, -0.2528623, -0.16057856, -0.54710466, 0.31266987, -0.09160009, 0.16193159, 0.47266668, -0.21671277, -0.14468367, 0.15172502, -0.23139489, 0.4850074, -0.028926272, -0.10947591, 0.6029151, 0.29127136, -0.2672302, 0.6199294},
    {-0.5948429, -0.6176773, 0.46367836, 0.83774215, 0.33429265, 0.5640505, -0.03535662, -0.7948648, -0.83557975, 0.3217333, 0.80980796, -0.6034954, -0.3047117, 0.29262406, 0.33390397, 0.78849465, 0.4957591, -0.43218312, 0.38187873, -0.5068971, -0.2583973, 0.53700423, 0.8121305, -0.29350758, 0.43918794, -0.9081979, -0.4920323, -0.18714277, -0.65706414, -0.5950383, 0.5657695, -0.57989603},
    {-0.08013995, -0.36773312, 0.7606418, 0.8254824, 0.4776445, 0.41352913, 0.034539342, -0.23156811, -0.6423893, 0.26780677, 0.26837742, -0.6369501, -0.4928027, 0.49567604, 0.07448864, 0.38537732, 0.364006, -0.47352752, 0.2739009, -0.21299408, -0.41305068, 0.3582783, 0.44005328, -0.51407796, 0.5474241, -0.83618426, 0.14292163, -0.30843398, -0.4933423, -0.77537394, 0.7680763, -0.53261864},
    {-0.17149557, 0.45998138, -0.03569868, -0.15720378, -0.8007036, -0.29608965, 0.30286884, 0.51020527, 0.47540432, -0.91187257, -0.47682253, 0.6146456, -0.31500486, 0.6982217, 0.29928008, -0.8337974, -0.8155663, 0.65650475, -0.36999616, 1.1280346, 0.0747005, -0.93462396, -0.7650051, 0.92958057, 0.10221025, 0.8209797, 0.5609332, 0.44857234, 1.0323205, 0.79460454, -0.6447303, 0.4996654},
    {-0.33805376, 0.37281463, 0.02927126, -0.086870156, -1.0505861, -0.11401948, 0.42269206, 0.63804495, 0.5087472, -0.921181, -0.9299533, 0.5897599, -0.75355387, 0.8454097, 0.6282187, -0.9313455, -0.57363117, 0.3908116, -0.5702227, 0.751169, 0.47261736, -0.951508, -1.1249521, 0.29497284, 0.38018495, 0.4871935, 0.9039935, 0.12905411, 0.9113066, 0.8125918, -0.67283887, 0.7347392},
    {-0.49328184, -0.5284281, 0.7602564, 0.73792845, -0.12558724, 0.30716866, 0.33281794, -0.4690047, -0.23338509, 0.3375963, 0.1045757, -0.3595202, -0.17515837, 0.571731, 0.1713042, 0.46424073, 0.2775605, -0.59812224, 0.33817437, 0.1667011, -0.55065745, 0.22542554, 0.07309719, -0.08074344, 0.31534958, -0.8638848, -0.23943318, 0.23293325, 0.17320836, -0.46300128, 0.4093131, -0.4245461},
    {0.52189714, -0.5100428, -0.20477623, 0.22774564, 0.7706814, -0.3224051, -0.83793634, -0.13239081, -0.30880135, 0.76017493, 0.37091753, -0.0025688938, 0.6312302, -0.645979, -0.44801703, 0.9595823, 0.66613704, -0.04467226, -0.030591702, -0.97224677, 0.17363532, 0.429423, 0.9547999, -0.13223556, 0.034470975, 0.08291133, -0.7653194, -0.037024792, -1.0616059, -0.11299408, 0.29675534, -0.16114776},
    {-0.3135978, -0.24376273, 0.2329143, 0.322559, 0.059434466, 0.014577414, 0.122868, -0.23205769, -0.052001067, 0.3472559, 0.26377463, -0.34574202, -0.47180372, 0.36755517, 0.3613485, 0.18182361, 0.3404815, 0.050065007, -0.21465422, -0.38590723, -0.30481368, 0.09761668, 0.2828089, -0.14595106, -0.093175806, -0.33152252, 0.069228046, -0.3331562, -0.07554998, -0.15278214, 0.23839517, -0.23393774},
    {-0.5699696, 0.007004043, 0.067180365, -0.18013759, -0.8781841, 0.3216677, 0.62384266, 0.49447095, -0.02234065, -0.16746692, -0.40467566, 0.05730705, -0.30412, 0.7003558, 0.6857623, -0.59539586, -0.270223, -0.17992745, 0.1652372, 0.5218559, -0.20544797, -0.4652043, -0.70330966, 0.6677657, -0.19477706, -0.012355753, 0.61482936, 0.4060276, 0.7910461, 0.50803113, -0.1778493, 0.6529187},
    {-0.573876, -0.38904777, 0.255006, 0.11276656, 0.117638916, 0.17042746, 0.5656843, -0.0820236, 0.06746694, -0.11335057, 0.09103415, -0.02962014, -0.35217658, 0.64231247, 0.3645582, -0.20318864, -0.0770585, -0.41876063, 0.30387798, 0.1308128, -0.34415483, -0.030308349, -0.43690962, -0.3386289, 0.5016893, -0.5829311, 0.16872601, 0.19232692, 0.056457687, -0.12590066, 0.48877344, 0.11716583},
    {-0.07055173, 0.2832443, 0.1825209, -0.028057745, -0.15620936, -0.016490618, 0.51746726, 0.056335617, 0.3620914, -0.47912988, -0.59133357, 0.47742248, -0.569949, 0.2132537, 0.57518333, -0.6091977, -0.47251794, 0.23430356, -0.1896513, 0.3443586, 0.51352984, -0.6688424, -0.35458237, 0.30671528, 0.4025758, 0.32856518, 0.4373598, -0.103092544, 0.080563925, 0.03948115, -0.16905726, 0.24970882},
    {0.31108662, -0.43398678, -0.12511492, 0.2207501, 0.6982331, 0.049055807, -0.6600774, -0.17606269, -0.071742386, 0.5571713, 0.50606024, -0.3100126, 0.430682, -0.27497035, -0.4431129, 0.37579724, 0.57715607, -0.10171231, 0.46531513, -0.53902143, -0.09359648, 0.7337889, 0.5274131, -0.11683734, -0.07690579, -0.29415774, -0.57904714, -0.28990158, -0.28956005, -0.03244699, 0.35579085, -0.31297684},
    {-0.561219, -0.1444729, 0.2832871, 0.19431464, -0.21095408, 0.46185765, 0.40231517, 0.3830229, -0.273343, -0.1867855, 0.048868712, -0.03534353, -0.34922308, 0.279017, 0.48565307, -0.015551273, 0.23253807, -0.058377948, 0.34153345, 0.42806408, 0.04011698, -0.19021524, -0.28271598, -0.12563473, 0.03752817, -0.1316018, 0.4604177, 0.024151912, 0.5063123, -0.23717383, -0.03534348, 0.31374624},
    {-0.22345898, -0.6247494, 0.7601223, 0.74928534, 0.09990128, 0.7304061, 0.45843983, -0.19917288, -0.41824308, 0.3023614, 0.2007995, -0.34510002, -0.5081667, 0.5351767, 0.56238794, 0.04838687, 0.31862074, -0.49023494, -0.01891539, 0.026437495, -0.18970075, 0.18696125, 0.516542, -0.6031555, 0.3057594, -0.5091214, -0.022216408, -0.24173397, -0.16330813, -0.77160054, 0.56765795, -0.60242385},
    {-0.29285774, -0.3751071, 0.72103083, 0.40230387, 0.13377392, 0.75591487, -0.22255144, -0.5322149, -0.46361774, 0.16195425, 0.6386417, -0.5809645, -0.48690283, 0.41561234, 0.6112979, 0.38831523, 0.8608505, -0.3534236, 0.112992816, 0.044847954, -0.778913, 0.006095931, 0.42060536, -0.24899307, 0.091211274, -0.6743314, 0.17372786, -0.10751266, -0.1910666, -0.38021725, 0.7220478, -0.119710825},
    {0.5832986, 0.410675, -0.8295636, -0.5259764, 0.109872445, -0.9491962, 0.012456716, 0.53998303, 0.3152329, -0.47819442, -0.16546239, 0.36902198, 0.50882614, -0.7615887, -0.5932678, 0.0009954697, -0.20860869, 0.7228665, -0.49141157, -0.08882629, 0.5357212, 0.0036372663, -0.27902165, 0.70536774, -0.30776963, 0.6896824, -0.30539685, -0.050331313, -0.077754095, 0.4154193, -0.58167195, 0.71204865},
    {-0.5356101, 0.03009765, 0.5646515, 0.27325454, -0.87420887, 0.31471077, 0.5111957, 0.4860822, 0.057273775, -0.38931116, 0.040391214, -0.22220095, -0.5895504, 0.65741295, 0.53127253, -0.11320638, -0.31339183, -0.22396092, 0.29729074, 0.9468007, -0.37605157, -0.25183135, -0.46098137, 0.4258218, -0.0116000855, -0.3814096, 0.5749039, 0.5081751, 0.45970905, 0.31428757, -0.14966896, 0.65323806},
    {0.70353293, 0.049346875, -0.3944547, -0.5693744, 0.86214745, -0.39027512, -0.6151908, 0.39346564, 0.06488041, 0.40116867, 0.46073613, 0.076873325, 0.5499748, -0.6522085, -0.6223089, 0.6459623, 0.8127668, 0.26604375, 0.04132844, -0.8225991, 0.039973088, 0.7727214, 0.7084988, -0.14384003, -0.0038142016, 0.33596826, -0.65948206, -0.0062476704, -0.58721447, 0.017322587, -0.21332291, -0.48141673},
    {0.08874693, 0.23405299, 0.30512547, -0.536282, -0.7888075, -0.1000748, 0.26680502, 0.68588924, 0.02079771, -0.6653579, -0.70224863, 0.50597763, -0.25228715, 0.40355846, 0.5005057, -0.43151265, -0.7481068, 0.45968732, -0.024776183, 0.8947795, -0.030485999, -0.75270367, -1.0835627, 0.707276, 0.22836637, 0.59322864, 0.44726744, 0.3142405, 0.6579152, 0.7052045, -0.64633644, 0.26525128},
};

	double biases_hidden_layer2[NUM_HIDDEN] = {0.07552625, 0.06536851, -0.1411714, -0.12937464, 0.08303206, -0.17981687, -0.0068518277, 0.30377975, 0.066680215, 0.038045604, 0.059739914, 0.027768068, -0.0016448764, -0.108808264, 0.019894905, 0.07239499, 0.05480321, 0.06818019, -0.0937545, 0.057362754, 0.08765837, 0.010239823, 0.0041571558, 0.11095555, -0.04130381, 0.25975105, -0.11125983, -0.018960569, 0.025119763, 0.1747599, -0.052821357, 0.08942258};

	double weights_output_layer[NUM_HIDDEN][NUM_OUTPUTS] = {
    {-0.031886265, -0.51793516, 0.042095426, 0.7151812},
    {-0.73478484, -0.32024774, 0.724363, 0.24992746},
    {0.44168147, 0.5564083, 0.16617015, -0.55524087},
    {0.45063344, 0.49099162, -0.27754074, -0.48446003},
    {0.5626704, -0.72210693, -0.8204611, 0.59098685},
    {0.06469385, 0.25321656, -0.4431523, -0.8405459},
    {-0.1045494, 0.07999433, 0.16794, -0.7142319},
    {-1.1965885, 0.1203129, 0.41656917, 0.5600272},
    {-0.52899426, -0.48357272, 0.6273374, 0.17958216},
    {0.48552758, -0.1718775, -0.9953872, 0.0049357126},
    {0.78843963, 0.18427801, -1.0132006, 0.10932192},
    {-0.7360391, -0.5086534, 0.8213216, 0.1984269},
    {-0.24614412, -0.24431743, -0.7407991, 0.6861748},
    {0.06140988, 0.08214886, 0.05735801, -0.78663963},
    {0.24935664, -0.031293824, 0.3174439, -0.81225544},
    {0.57794243, -0.24739917, -1.11186, 0.09521861},
    {0.71537924, 0.18259276, -0.7591875, 0.09668708},
    {-0.8305989, -0.20883323, 0.2659864, 0.50327855},
    {0.10463161, 0.48527965, -0.520218, -0.2430383},
    {-0.33847612, 0.6040884, 0.5794693, -0.53239566},
    {-0.46787834, -0.6343695, 0.6912094, 0.6496255},
    {0.39853287, -0.30299965, -0.8309022, 0.41058815},
    {0.83499414, -0.22290617, -0.6625375, 0.31073496},
    {-0.91584164, 0.5270457, 0.6427371, 0.35785338},
    {0.1619655, -0.24041352, -0.07041148, -0.6280053},
    {-0.9505524, -0.6278931, 0.5038075, 0.46687454},
    {-0.2588289, 0.53685623, 0.41731364, -0.9241969},
    {-0.2396484, 0.5016448, -0.1402601, -0.15913844},
    {-0.5603139, 0.47044525, 0.39043465, -0.3866808},
    {-1.0644116, -0.33582062, 0.26163772, -0.023376508},
    {0.6972124, 0.096876174, -0.64594513, -0.4687943},
    {-0.70680755, 0.119883545, 0.26936215, 0.0051830234},
};
	double biases_output_layer[NUM_OUTPUTS] = {
0.105693914, 0.052876428, -0.057132255, -0.18855202};

	// Compute values for hidden layer 1
	for(int i = 0; i < NUM_HIDDEN; i++){
		hidden_layer1[i] = 0;
		for(int j = 0; j < NUM_INPUTS; j++){
		    // std::cout << "dotting " << inputs[j] << "with " << weights_hidden_layer1[j][i] << "  " ;
			hidden_layer1[i] += inputs[j] * weights_hidden_layer1[j][i];
		}
		// std::cout << hidden_layer1[i] << " ";
		hidden_layer1[i] += biases_hidden_layer1[i];
		hidden_layer1[i] = sigmoid(hidden_layer1[i]);
	}

	// Compute values for hidden layer 2
	for(int i = 0; i < NUM_HIDDEN; i++){
		hidden_layer2[i] = 0;
		for(int j = 0; j < NUM_HIDDEN; j++){
		    hidden_layer2[i] += hidden_layer1[j] * weights_hidden_layer2[j][i];
		}
		hidden_layer2[i] += biases_hidden_layer2[i];
		hidden_layer2[i] = sigmoid(hidden_layer2[i]);
	}

	// softmax implementation
	double offset = outputs[0];
	double sum = 0.0;


	// Compute values for output layer
	for(int i = 0; i < NUM_OUTPUTS; i++){
		outputs[i] = 0;
		for(int j = 0; j < NUM_HIDDEN; j++){
			outputs[i] += hidden_layer2[j] * weights_output_layer[j][i];
		}
		outputs[i] += biases_output_layer[i];
	}

	// Compute the exponential of each input
	for (int i = 0; i < NUM_OUTPUTS; i++) {
		softmax_outputs[i] = exp(outputs[i]-offset);
		sum += softmax_outputs[i];
	}

	// Normalize the outputs by the sum of exponentials
	for (int i = 0; i < NUM_OUTPUTS; i++) {
		softmax_outputs[i] /= sum;
	}

	double max = softmax_outputs[0];
	int ans = 0;	 

	for (int i = 0; i < NUM_OUTPUTS; i++) {
        if (softmax_outputs[i] > max) {
            ans = i;
        }
    }

    return ans;
}

int main() {
    double inputs1[INPUT_SAMPLES][NUM_INPUTS] = {
    {0.017314464190467227, 0.7821381516657591, 1.0, 0.7851502881374393, 0.8214685624410034, 0.777309756018898, 1.0, 0.7438152161080576, 0.8758875965614796, 0.0, 0.8176854178020512, 0.6521847636448815, 0.9915502727104807, 0.14720052571656392, 0.2867605526436922, 0.0, 0.0, 1.0, 0.0, 0.8176854178020512, 0.6521847636448815, 1.0, 0.0, 0.0},
    {0.7327470560085914, 0.7670054540398284, 0.7876194904561352, 0.0003777085979821404, 0.004562143134149377, 0.015229133588794186, 0.008489068444362813, 0.0, 0.009446904812559165, 0.9824486506311336, 0.5290985126034317, 0.38614894284325796, 0.9494529308687075, 0.0, 0.07397361806125458, 0.59476694098463, 0.7198436209281258, 0.26609692233259596, 0.9824486506311336, 0.5290985126034317, 0.38614894284325796, 0.5751971490522738, 0.5788592538242026, 0.6546772353702576},
    {0.6303608153040674, 0.6459125042423195, 0.7726308539512028, 0.009468520442085682, 0.011712710762579626, 0.017824833108515348, 0.005093946644663561, 0.019465654191712645, 0.015376622627928382, 0.83442008939342, 0.41204243574476007, 0.9999999999999999, 0.9916250943994421, 0.3075444576465419, 0.3291439600701033, 0.5410450286608446, 0.665238985485304, 0.1066198430894188, 0.83442008939342, 0.41204243574476007, 0.9999999999999999, 0.5787903934852892, 0.6250082118276563, 0.5450281584503717},
    {0.6522639521708093, 0.5505606440131224, 0.7592430676622473, 0.0, 0.0, 0.0, 0.0, 0.0047103240218238085, 0.0, 0.7469269261405295, 0.6540769780819387, 0.48900901327472834, 1.0, 0.2661700890020115, 0.2057585278383944, 0.583041640151744, 0.7457313758113601, 0.09223203419799791, 0.7469269261405295, 0.6540769780819387, 0.48900901327472834, 0.577763837422617, 0.5693925573430506, 0.5870560088071526},
    {0.0, 0.7878431164406379, 0.6870106909630802, 0.1287997530906948, 0.04890807975145384, 0.11378937234541442, 0.07753320210333703, 0.3867255070794684, 0.12348765216436264, 0.8663248888827084, 1.0, 0.28347135356732167, 0.2654557598637883, 0.9525514116146542, 0.4973485965097738, 0.36541609268994457, 0.8711934524925733, 0.11531701824106748, 0.8663248888827084, 1.0, 0.28347135356732167, 0.5362222766191846, 0.4115857831263833, 0.8471261015945116},
};

        double inputs2[INPUT_SAMPLES][NUM_INPUTS] = {
    {0.6119465061745757, 0.6218615866506558, 0.8247520374198509, 0.004425090570110424, 0.011573449376346634, 0.01782192516370018, 0.006476058235981963, 0.01700592625590769, 0.02671914595596636, 0.7506427637367405, 0.523920307626935, 0.5771615119830117, 0.96992899264749, 0.03890503607357165, 0.1488114949388816, 0.5584137403957962, 0.6318775071171581, 0.0, 0.7506427637367405, 0.523920307626935, 0.5771615119830117, 0.5737861066377319, 0.5366009547206743, 0.6607060642724225},
    {1.0, 1.0, 0.9588559268054189, 0.9999999999999999, 1.0, 0.9999999999999999, 0.9075333111495821, 1.0, 1.0, 0.7771836030460059, 0.737943259358457, 0.0, 0.9701045664191169, 0.06884189478651967, 0.0, 1.0, 0.7296879371881688, 0.5045655892032859, 0.7771836030460059, 0.737943259358457, 0.0, 0.0, 0.755678308315113, 1.0},
    {0.6586664756046536, 0.6286522794868735, 0.5664736109078621, 0.05846116701627224, 0.08105681469422565, 0.12362188907497207, 0.1513665311959831, 0.14438876102193987, 0.10571943377392401, 0.5120061750880759, 0.4189968736538636, 0.6792650841012186, 0.0, 0.9999999999999999, 0.3402108706430609, 0.6637111422296045, 0.5638965501755664, 0.08327338029939091, 0.5120061750880759, 0.4189968736538636, 0.6792650841012186, 0.43562026380461916, 0.5420489385698737, 0.4282439748182414},
    {0.7975437916787183, 0.0, 0.0, 0.04806708589931641, 0.1318764726324846, 0.1945250423521392, 0.35940717174023606, 0.22536051647408462, 0.1599809303515305, 1.0000000000000002, 0.0, 0.24444412459948572, 0.9823703833154335, 0.0871238893315058, 0.26163505222550465, 0.5728443386605723, 1.0, 0.7620668590118296, 1.0000000000000002, 0.0, 0.24444412459948572, 0.21168607891118563, 0.9999999999999999, 0.5206960529703674},
    {0.8472006319199172, 0.4368460523119898, 0.8660547928197485, 0.01209612244537106, 0.0039126623190886, 0.009083683174200718, 0.005883408415528368, 0.008101066487084196, 0.00822964459344977, 0.7592705236428834, 0.5481947680656688, 0.5976171511027247, 0.040369872059940304, 0.8451648690740803, 0.9999999999999999, 0.6255079652150809, 0.7491747235694894, 0.04109684352160091, 0.7592705236428834, 0.5481947680656688, 0.5976171511027247, 0.5831288163108683, 0.5526001638362918, 0.615643070260733},
};

    double expectedOutput[TOTAL_SAMPLES] = {3, 2, 1, 1, 0, 2, 3, 0, 2, 0 };
    
    int j = 0;
    int count = 0;
    
    // print mlp(inputs)
    for (int i = 0; i < INPUT_SAMPLES; i++) {
        std::cout << "achieved output: " << mlp(inputs1[i]) << std::endl;
        std::cout << "expected: " << expectedOutput[j] << std::endl;
        if (mlp(inputs1[i]) == expectedOutput[j]) {
            count++;
        }
        j++;
    }
    
    for (int i = 0; i < INPUT_SAMPLES; i++) {
        std::cout << "achieved output: " << mlp(inputs2[i]) << std::endl;
        std::cout << "expected: " << expectedOutput[j] << std::endl;
        if (mlp(inputs1[i]) == expectedOutput[j]) {
            count++;
        }
        j++;
    }
    
    std::cout << "count of passed cases: " << count << std::endl;
    std:cout << "Accuracy of model: " << (count*100)/TOTAL_SAMPLES << "%" << std::endl;

    return 0;
}
