
#include <math.h>
#include <iostream>

#define NUM_INPUTS 24
#define NUM_HIDDEN 32
#define NUM_OUTPUTS 4
#define INPUT_SAMPLES 5

double sigmoid(double x) {
    return 1.0 / (1.0 + exp(-x));
}

int mlp(double inputs[NUM_INPUTS]) {

	double hidden_layer1[NUM_HIDDEN];
	double hidden_layer2[NUM_HIDDEN];
	double outputs[NUM_OUTPUTS];
	double softmax_outputs[NUM_OUTPUTS];

    // Initialize weights and biases for the hidden layers and output layer
	double weights_hidden_layer1[NUM_INPUTS][NUM_HIDDEN] = {
    {-0.014344019, 0.08412489, 0.24860229, -0.18913378, 0.30431247, 0.2234157, 0.16662444, -0.23875545, 0.20187253, 0.24853848, 0.002642458, -0.088130824, -0.10354445, 0.037162848, -0.17334682, -0.17916192, -0.29214498, 0.31944054, -0.25557038, 0.2307524, -0.25682536, -0.24030507, 0.17481342, 0.3643182, 0.079217166, -0.024096467, -0.20080534, 0.22539608, 0.04007651, -0.027561482, 0.2636712, -0.09119299},
    {-0.1188624, -0.15311673, 0.17074984, -0.11372132, 0.10265245, -0.30607477, 0.16014943, -0.0020321673, 0.05188633, 0.1226059, -0.047107905, 0.1482375, -0.009665726, 0.36906934, 0.24738657, -0.17890006, 0.3998998, -0.13167557, -0.23261644, -0.011946167, -0.07091863, 0.19583687, 0.09661747, 0.25134525, -0.17499426, 0.117293596, 0.26880303, -0.0019497174, -0.33775792, -0.16730534, -0.27109763, -0.1081532},
    {0.05231432, -0.13112174, -0.24685301, -0.3133088, -0.3354791, 0.03654033, 0.049214456, -0.108371526, -0.22926362, 0.2809424, 0.0047975453, -0.024018385, -0.26971102, -0.036584094, 0.20073238, 0.29819915, 0.31797573, 0.050599527, 0.2931115, 0.4030007, -0.08169447, 0.28731737, -0.22878575, 0.12527968, -0.15399721, 0.05572553, -0.0055871517, -0.045897007, -0.25037366, -0.29185227, -0.15460965, -0.004960685},
    {-0.9752165, 0.70756674, 0.15199031, 0.6259807, 0.7101187, 0.77985185, -0.5045928, 0.27490026, 0.64122987, -0.081927255, -0.53298813, 0.7226082, 0.060087774, -0.7890481, -1.1023912, -0.44021097, -0.47926262, -0.8198404, -0.4474661, -0.7459123, -0.7432797, -0.14720523, 0.3239087, 1.2697009, -0.84978926, 0.2722436, -0.80958074, 0.34747738, -0.681546, 0.7990405, 0.36726898, -1.2079649},
    {-0.7532504, 0.3793239, 0.16684179, 0.49509078, 0.29103103, 0.144898, -0.24413465, 0.26953706, 0.12618974, 0.15655418, -0.00028092242, 0.41692454, -0.14579663, -1.0708278, -1.1320381, -0.122643, -0.20029153, -0.21536045, -0.016081667, -0.46564865, -0.741822, -0.62300974, 0.3216794, 0.82839376, -1.140506, 0.58278936, -0.99986285, 0.71727073, -0.7556413, 1.29372, 0.2804404, -1.2013965},
    {-0.6335287, 0.63221437, 0.10202236, 0.15095283, 0.09345379, 0.25761965, -0.020096863, 0.105128706, 0.30646652, 0.43494445, 0.34663346, 0.33132285, 0.20985115, -0.8532365, -1.4012568, -0.0896597, -0.2122164, -0.19125922, 0.351978, -0.13398081, -0.48956913, -0.08805121, 0.24298765, 1.0901998, -0.90041417, 0.022967538, -0.8156897, 0.3626541, -0.8050476, 1.0934488, 0.18086013, -1.6426802},
    {-0.92542803, 0.83909464, 0.20740263, 0.5018825, 0.9504621, 0.85024387, -1.0194793, 0.77394265, 0.9303463, -0.5521792, -1.0204046, 0.5635205, 0.17174515, -1.1254294, -0.836828, -0.2511314, -0.8010597, -0.7151681, -0.29949838, -0.66479266, -0.52722937, -0.81699824, 0.5995313, 1.1301388, -1.176095, 0.8282886, -1.1679064, 0.7879672, -0.15108316, 0.50346756, 0.58947057, -1.5129546},
    {-1.0600288, 0.23005201, -0.19022514, 0.1412248, 0.6086993, 0.66029054, -0.07394065, 0.4342851, 0.62772304, 0.038812473, -0.07815984, 0.44528693, 0.27084613, -1.0165758, -0.8466503, -0.46322328, -0.44805488, -0.32156128, -0.30343255, -0.15482889, -0.66525066, -0.5528389, 0.46605787, 0.894387, -0.5116395, 0.18828642, -0.8812849, 0.39557803, -0.52627665, 1.103493, 0.1648476, -1.0926975},
    {-0.81903625, 0.19929244, 0.014828823, 0.52142704, 0.3169915, 0.60647887, -0.46944255, 0.032324675, 0.3035352, 0.21695104, -0.06201051, 0.18752924, 0.075988, -1.024509, -1.3394946, -0.34670094, 0.030614408, -0.21954386, -0.24018861, -0.5673718, -0.61495125, -0.105360046, 0.5858946, 1.0363092, -0.6162085, 0.105342545, -1.0027424, 0.51571375, -0.40696394, 1.056664, 0.47474837, -1.4766268},
    {-0.27288204, -0.05972813, -0.28513372, -0.34809905, 0.119579345, -0.14971443, 0.050258826, -0.021303449, -0.24685122, -0.2050979, 0.15699366, 0.26322693, 0.23205453, 0.07120826, 0.112705365, 0.106641084, -0.14898308, -0.020901967, -0.26289916, 0.1709653, -0.037029006, -0.09241485, -0.2572931, 0.037012417, -0.21024372, -0.25247717, -0.19316427, 0.09153711, 0.2015794, 0.2607183, 0.16567242, -0.02158139},
    {-0.14215782, 0.0321769, 0.13785604, 0.14479047, -0.023413273, -0.16839989, -0.21234474, -0.0728753, -0.008552531, 0.04111813, -0.0036754804, -0.17506208, -0.058968086, -0.007117614, -0.19851127, -0.08243196, 0.044360273, 0.10983252, 0.13142456, 0.105663724, -0.014583617, 0.19627012, 0.13610505, 0.34851003, 0.379987, -0.07405743, 0.058218084, -0.042117786, 0.0015200821, 0.22743623, -0.17483117, 0.2553761},
    {-0.030290904, 0.32049945, 0.113312975, 0.15100738, 0.24719287, -0.07843914, -0.19613126, -0.26111993, -0.2685682, 0.07534636, 0.11219337, 0.05776632, -0.24827836, -0.34587497, 0.19987023, -0.27360034, 0.13918361, 0.23574331, 0.20210755, -0.25405154, 0.14323106, -0.28537592, -0.26066625, 0.048566755, 0.034242954, 0.19578181, -0.38496464, -0.29802534, 0.27858856, 0.123125255, 0.29589203, -0.23018944},
    {1.6344591, 1.1109312, 1.6452641, 1.0410883, 0.92101765, 1.1559138, -0.9575966, 1.3323476, 0.8454446, -1.0641038, -0.8274771, 1.1083022, 0.93654, 0.615946, 1.7002183, -1.0834105, -1.5687621, -1.0723195, -0.91180545, -0.6296228, -0.64885545, -1.347056, 1.5871247, -1.5972495, 0.9271246, 1.2909497, 0.90852803, 0.7469695, 1.253037, -1.3265787, 0.90354806, 1.8184172},
    {-0.7560645, -0.5372411, -1.2276882, -1.2020746, -1.646713, -1.2483447, 1.5388113, -1.2524797, -0.86327136, 1.5974555, 1.8296115, -1.5985681, -1.5560074, -0.07588387, -0.6779093, 1.2826562, 1.277793, 1.3021426, 1.45113, 1.5623156, 1.5771843, 1.1222782, -0.7484854, -0.32847938, 0.07322745, -1.4722432, 0.4713216, -0.46035343, -1.1171075, 1.3407054, -1.269742, -0.61767626},
    {0.017529124, -0.3980781, -0.37095064, -0.70497596, -0.35387096, -0.47727466, 0.7046851, -0.33789498, -0.7592377, 0.41930768, 0.30389446, -0.4182167, -0.58369565, -0.15863624, -0.62612426, 0.7478992, 0.36242586, 0.31558448, 0.7468556, 0.2313934, 0.4927918, 0.2518705, -0.40090972, 0.014444469, 0.12207593, -0.59385586, 0.23536757, -0.32699934, -0.6979146, 0.66904193, -0.46693793, -0.5184792},
    {0.08772714, -0.035108436, -0.13357057, -0.10242039, 0.17067868, -0.2700879, 0.16967204, 0.2416907, 0.012685067, 0.32462338, -0.17993928, 0.02745055, -0.32916167, 0.28891107, -0.33130205, 0.14346291, -0.023107199, -0.10815782, -0.051559452, 0.29757056, -0.019761523, 0.06411426, -0.00017444073, -0.123398855, 0.081362896, -0.26805657, 0.21377, 0.01274526, 0.05678668, -0.035558328, 0.20622382, 0.18262944},
    {-0.24626212, 0.060223382, -0.19657011, 0.1578574, -0.34575006, -0.22240852, 0.08920613, -0.2766921, 0.1142778, -0.03884801, -0.035388615, -0.044521954, 0.32624847, -0.04435533, 0.16835833, -0.15731928, 0.07822267, 0.21054399, 0.3295265, -0.3008035, 0.061418492, 0.26978746, -0.24320811, -0.011932816, 0.2206668, -0.2762624, -0.25292933, 0.14558026, 0.034242053, 0.08195122, 0.18015213, -0.32650933},
    {-0.19827291, -0.3302856, -0.32119304, 0.026463484, -0.15785111, -0.19304955, 0.102263294, 0.24834715, -0.024042545, -0.24674255, -0.038060345, 0.051872164, 0.2692588, 0.37312096, -0.1482005, -0.02292304, 0.055782277, -0.16936941, 0.2881363, 0.16018963, 0.20907567, 0.20933872, 0.024504097, 0.15145054, -0.24437025, 0.22401339, 0.0700197, -0.24908946, -0.27378613, 0.22936738, -0.13591021, -0.28779516},
    {-0.028306227, -0.2082306, -0.21796471, 0.01665237, 0.0022096375, 0.07477291, -0.15507759, -0.046974648, -0.23030266, 0.17805777, 0.25349033, 0.09146501, 0.27723053, -0.0005146341, -0.117470264, 0.24623209, 0.14515091, -0.19413368, 0.1340359, 0.16568194, 0.26927313, 0.34090412, -0.05538547, 0.23418991, -0.12641197, -0.095678926, -0.12345716, -0.37766033, 0.24704303, -0.18053785, -0.17235035, -0.15544659},
    {0.12973855, 0.08523866, 0.045198392, 0.16417253, -0.25742018, -0.29361755, 0.3472812, -0.25088677, 0.10773271, -0.17408457, -0.12874678, -0.34858838, 0.014721065, 0.07799443, -0.198381, -0.13950016, 0.19675328, 0.39682102, 0.0128175095, -0.15708429, 0.4066206, 0.12549937, -0.2785511, -0.28285956, 0.052757405, -0.14511798, -0.043815333, 0.10549272, 0.07258686, -0.25806227, 0.07567894, -0.047082808},
    {-0.122517675, -0.3102714, -0.116223134, -0.2445673, -0.12097548, -0.15519436, 0.12353778, -0.11027665, 0.09501054, -0.15079401, -0.3070182, -0.19250555, -0.050751086, -0.38112906, -0.386318, 0.20249626, 0.08384827, 0.16051966, 0.17086816, -0.04148031, -0.023527883, -0.32025734, 0.088752724, -0.1462169, -0.1098156, 0.11207478, 0.09104593, -0.17914875, -0.14811957, 0.053581953, -0.09715039, -0.0013112514},
    {0.18836032, 0.040714357, -0.027709728, -0.015054334, -0.3317383, 0.18412519, -0.02361267, 0.12688074, -0.0879169, -0.2869494, 0.36478725, -0.08691554, 0.26134312, 0.25108412, 0.1564996, 0.120072424, -0.15547991, 0.15744652, -0.15964699, -0.09781769, 0.21867709, 0.266664, 0.01879311, 0.003972438, 0.15645544, 0.025332924, 0.042218756, 0.13466825, 0.0700959, 0.14265466, -0.36809057, 0.22088566},
    {-0.15717159, -0.3904609, -0.15514511, 0.22682199, -0.2797636, 0.14522502, -0.15846182, 0.012914017, 0.00443653, 0.13098623, 0.11899913, -0.27073166, -0.34600502, 0.4063826, 0.08791577, 0.078334056, 0.19978108, -0.10632954, -0.17943807, 0.13956423, 0.08665636, 0.31095907, 0.09408456, 0.053207662, -0.23570636, -0.32394078, -0.1917141, -0.23252371, -0.18406543, -0.15333925, -0.059905786, 0.18366139},
    {0.08161656, 0.091320366, 0.11147877, 0.14798416, 0.031246787, -0.091549166, 0.020703593, -0.10264257, -0.27940983, 0.08847338, -0.01846436, -0.28950098, -0.27293375, 0.21025994, 0.262962, 0.24508469, 0.17032501, 0.12724245, -0.18093427, -0.1328274, -0.110530645, -0.16024975, -0.036399134, 0.03291289, 0.05093827, 0.16631386, 0.23846935, -0.17532304, 0.06552285, -0.05804224, -0.32375538, 0.22280805},
};
	double biases_hidden_layer1[NUM_HIDDEN] = {-0.026663048, -0.06855672, -0.09912418, -0.05944084, -0.09603077, 0.028348671, 0.052210253, -0.02304174, 0.014875561, 0.020585148, 0.061845303, -0.043263692, -0.037514735, 0.089395605, -0.03796994, 0.046085175, 0.10431717, 0.076736055, 0.059176426, 0.045363326, 0.053715907, 0.060694374, -0.1616624, 0.10113404, 0.010948281, -0.058191083, 0.08360747, -0.057150546, -0.0049222526, -0.019084956, -0.06710613, -0.022770856};

	double weights_hidden_layer2[NUM_HIDDEN][NUM_HIDDEN] = {
    {0.045013845, 0.7710655, 0.3246734, -0.44620076, -0.642162, -0.16023047, -0.39456317, -0.045982342, 0.37604547, -0.21900928, -0.23164532, 0.61699885, -0.43149242, -0.258482, 0.73754853, 0.3808218, -0.21248756, 0.1975504, 0.86503893, 0.4614621, -0.49391523, -0.39886764, -0.44604132, 0.30224597, -0.14867352, 0.46361104, -0.77089256, -0.45187905, 0.15045217, 0.16306418, 0.2751239, 0.41897714},
    {-0.1033234, 0.528951, 0.31730786, -0.016025644, -0.5139259, 0.4307529, -0.56968, -0.49951282, -0.4921711, 0.23776117, 0.26820824, 0.006487944, -0.2986459, 0.24727966, -0.3998679, -0.28813508, 0.5126566, 0.17191325, -0.23810095, 0.46159095, 0.21593857, 0.20910671, 0.2363343, 0.4099707, 0.40292203, 0.16991602, 0.31674984, -0.41024238, -0.45094645, -0.06903508, 0.12692833, -0.16082425},
    {-0.32722622, 0.42366013, 0.38064185, -0.7308003, -0.26106545, 0.058638424, -0.6171683, -0.6827455, -0.3247571, 0.37318105, 0.45876575, -0.3920966, -0.33146307, 0.5731158, 0.19670853, 0.2041449, 0.49756688, 0.48640224, 0.5081786, 0.21913706, -0.3592439, -0.20092255, -0.09503978, 0.7691462, 0.39255565, 0.7389676, -0.07362478, -0.6817383, -0.17306864, -0.45686445, 0.6926547, -0.21363305},
    {-0.52670443, 0.25597626, 0.48024762, -0.80425626, -0.38660508, 0.4901075, -0.43025964, -0.6358812, -0.22393458, 0.6892122, 0.65190536, -0.48544112, -0.4196614, 0.64991, 0.073304266, 0.08307023, 0.25843504, -0.12989092, -0.1999515, 0.5651954, -0.30739495, -0.3806587, 0.12065973, 0.4471719, 0.59939516, 0.39850345, 0.07570665, -0.42375037, -0.49921182, -0.6339453, 0.23964638, -0.48180458},
    {-0.37883383, 0.08588446, 0.50061333, -0.79174775, -0.16378611, 0.5151774, -0.23536237, -0.49355868, -0.23043026, 0.14843635, 0.5017558, -0.3584471, -0.5775648, 0.43712574, 0.045560244, 0.27483952, 0.58093494, -0.116645426, -0.32334742, 0.32910958, 0.29413408, 0.15633504, 0.24685025, 0.26067314, 0.45383215, 0.24247971, 0.23639153, -0.4031435, -0.38640416, -0.38234073, 0.61125374, -0.2780615},
    {-0.50324047, 0.347496, 0.5965891, -0.36910924, -0.52754444, 0.6487075, -0.40649202, -0.47096413, -0.79276174, 0.22899799, 0.45285842, -0.21853995, -0.6865683, 0.8687455, -0.4898969, -0.20732076, 0.648386, -0.3511364, 0.19950734, 0.34052393, -0.016293548, 0.028829943, 0.24768107, 0.72468615, 0.5086152, 0.65980136, 0.4406429, -0.5253346, -0.75698996, -0.31953204, 0.7516432, -0.5831766},
    {0.4360495, -0.3744815, 0.04030899, 0.6150947, 0.17341359, -0.32443026, 0.5622416, 0.6715747, 0.35939726, -0.28511044, -0.44204682, 0.45051342, 0.8333905, -0.5140115, -0.31308982, -0.42187476, -0.4320814, -0.13574691, -0.09387124, -0.37721053, -0.07740931, 0.20443907, -0.47991872, -0.15922903, -0.6033175, -0.74013466, -0.45097226, 0.22438961, 0.74455726, 0.3761173, -0.70925987, 0.45388988},
    {-0.417428, 0.4380107, 0.69959974, -0.25376123, -0.1323813, 0.30179456, -0.29233223, -0.3630921, -0.4615918, 0.510278, 0.52005726, 0.055143677, -0.6118204, 0.44221568, -0.086435415, -0.11305992, 0.689254, -0.10736452, 0.3949679, 0.091123946, -0.06367811, -0.54064286, 0.13370228, 0.7198532, 0.017268788, 0.32029235, 0.3195229, -0.4529727, -0.31932464, -0.49652305, 0.5312211, -0.4528073},
    {-0.65794015, 0.5149298, 0.2873999, -0.48168007, -0.43495125, 0.42683777, -0.49112958, -0.5123861, -0.22815235, 0.19381692, 0.22524199, -0.0580984, -0.3390455, 0.5766874, -0.30988237, -0.18786888, 0.72461337, -0.32966757, -0.34008175, 0.34110144, -0.10127108, 0.028291613, 0.49826097, 0.1856988, 0.28496423, 0.6502288, 0.19872275, -0.5507859, -0.6854635, -0.48246732, 0.6329169, -0.32127318},
    {0.6177603, -0.45653105, -0.32090253, 0.9444947, 0.35253316, -0.62988776, 0.41282266, 0.59685314, 0.38638297, -0.50018245, -0.52099806, 0.17169362, 0.4007986, -0.2827538, -0.392514, -0.5254802, -0.6053638, -0.2794222, -0.29284334, -0.08080674, -0.013556614, 0.21893315, -0.03982885, -0.08048059, -0.6244644, -0.39799565, 0.21433192, 0.5712636, 0.19255587, 0.3170868, -0.31345063, 0.19143987},
    {0.778867, 0.086732365, -0.19724248, 0.6572141, 0.11225604, -0.7158175, 0.040022403, 0.14411539, 0.52727437, -0.18659292, -0.13702612, 0.34110218, 0.78380215, -0.67729837, 0.09069037, -0.41897082, -0.7873454, 0.28477672, -0.39454928, -0.15310603, 0.35204718, 0.04903702, -0.21416166, -0.35410342, -0.20671475, -0.481543, 0.04759168, 0.43854192, 0.72846985, 0.5194996, -0.66764927, 0.13750522},
    {-0.7593796, 0.6248322, 0.24213485, -0.42312965, -0.48457152, 0.62880445, -0.42974186, -0.20825, -0.5907401, 0.3753325, 0.8077463, -0.034117, -0.81369627, 0.7288508, -0.3466264, 0.1575252, 0.8577472, -0.136691, 0.18408929, 0.1789285, 0.10117457, -0.14155702, 0.45099953, 0.12889317, 0.2886533, 0.72310853, 0.3037933, -0.56051433, -0.64753455, -0.5913317, 0.7664526, -0.06784934},
    {-0.53622466, 0.09124418, 0.3746399, -0.74720246, -0.32873562, 0.35454935, -0.115064204, -0.3683322, -0.25430015, 0.2935877, 0.24469218, 0.06913906, -0.6116145, 0.39600667, 0.29760522, 0.09535709, 0.71693677, 0.0860623, -0.13196476, 0.30411544, -0.0937929, -0.10481681, 0.05087628, 0.15386115, 0.29302326, 0.56017727, 0.02727143, -0.44471693, -0.37370664, -0.3915112, 0.420228, -0.09442767},
    {0.21710765, 0.071569204, 0.15803888, 0.10325061, -0.10991104, -0.7253038, 0.13750139, -0.16944893, 0.73928267, -0.6732377, -0.54329646, 0.3132719, -0.08801064, -0.21320851, 0.43905824, 0.25954717, -0.017836813, 0.05929928, 0.6359586, -0.033321455, -0.28733587, -0.5850017, -0.6049892, -0.21208802, -0.22855501, -0.41954604, -0.3865648, 0.23309237, 0.71597767, 0.29512972, 0.07884761, 0.65658754},
    {-0.14677083, 0.7756399, 0.6464233, -0.6058564, -0.42505506, -0.23428556, -0.5058454, -0.49743357, 0.4823992, -0.107115276, -0.27987808, 0.43685752, -0.15215683, 0.084615454, 0.7768201, 0.4794267, -0.036295183, 0.22010067, 0.9340253, 0.43595365, -0.44192275, -0.9502127, -0.40486962, 0.6030085, 0.27111083, 0.32785708, -0.4526081, -0.65153277, 0.09697488, -0.15327305, 0.342492, 0.47090867},
    {0.48258424, -0.1481306, -0.5467668, 0.96272343, 0.12692408, -0.36698323, 0.6038372, 0.69548535, 0.7475311, -0.74176747, -0.45525628, 0.60615796, 0.37950486, -0.6379201, 0.16752575, -0.41070232, -0.6977394, -0.18304539, -0.35271245, -0.4402747, 0.44285864, 0.5082956, -0.061809286, -0.37590227, -0.31314462, -0.51352584, -0.00419289, 0.09144316, 0.7652706, 0.48775357, -0.87227297, 0.3416902},
    {0.50595737, -0.62152123, -0.40160018, 0.8421254, 0.69836706, -0.52307093, 0.61196935, 0.85746837, 0.8704077, -0.7645092, -0.31265938, 0.16635053, 0.910574, -0.77870053, -0.3779809, -0.0583818, -0.86050755, -0.17569454, -0.24994613, -0.5365004, 0.15659289, 0.46609893, 0.18012618, -0.42260954, -0.40727967, -0.8218568, 0.025335245, 0.75752157, 0.46231517, 0.49603084, -0.9278899, 0.32080683},
    {0.858, -0.5561882, -0.5501929, 0.5301817, 0.024471954, -0.29450497, 0.08596999, 0.7105027, 0.41143233, -0.629324, -0.7282359, 0.3923749, 0.55532575, -0.6558583, -0.05276256, -0.17874338, -0.74316585, -0.21616104, -0.10107494, -0.1747941, 0.04300652, 0.28167936, -0.34206522, 0.0036284123, -0.07236492, -0.54023045, 0.11062768, 0.28508696, 0.57668555, 0.27158257, -0.6130445, 0.56639236},
    {0.45772007, -0.41011712, -0.23694293, 0.960099, 0.16654322, -0.28086466, 0.4322197, 0.40698636, 0.31012163, -0.44099677, -0.49182233, 0.48263523, 0.6118162, -0.766717, -0.25226188, -0.267325, -0.56434476, 0.22541113, -0.43458498, -0.22908847, -0.06502844, 0.5487204, -0.033179514, -0.23721875, -0.25532326, -0.7782967, -0.381961, 0.36385936, 0.48353064, 0.3376868, -0.6970572, 0.21408051},
    {0.24404256, -0.10187566, -0.16635413, 0.6545046, -0.00040042133, -0.5391948, 0.47409323, 0.5925289, 0.43604732, -0.68191075, -0.7114423, 0.39175034, 0.5071955, -0.5363427, 0.10413787, 0.047173403, -0.52007616, 0.11972929, 0.26592022, 0.11261418, -0.19360821, 0.4160157, -0.40798652, -0.40740377, -0.11105756, -0.2539818, -0.33651295, -0.09425892, 0.3638989, 0.22755049, -0.39750898, 0.24075498},
    {0.6497629, -0.45091292, -0.34496218, 0.32254344, 0.1719625, -0.48115817, 0.2835692, 0.31811172, 0.5921839, -0.4891093, -0.52128375, 0.7083389, 0.3185276, -0.6174222, 0.16100064, -0.10947539, -0.46968764, 0.45298505, 0.07582814, -0.29374063, -0.0045554982, 0.2454506, -0.5762215, -0.10570491, -0.28852707, -0.2514147, -0.5397026, 0.11670535, 0.79802525, 0.66905606, -0.65633184, 0.22122332},
    {0.338145, -0.7056447, -0.651614, 0.4283953, 0.26657167, -0.43711853, 0.2116914, 0.65053105, 0.86648285, -0.29925904, -0.5801849, 0.23494014, 0.6034271, -0.41831318, 0.15188196, 0.007611971, -0.35643727, -0.37696996, -0.1959482, -0.30632445, 0.3222166, 0.37871507, -0.101571165, -0.46660763, -0.24452733, -0.5801596, -0.3375484, 0.37488136, 0.41722015, 0.41837046, -0.76056075, 0.41173998},
    {-0.52269316, 0.49006155, 0.51780194, -0.34822133, -0.6451185, 0.4322529, -0.22276258, -0.582834, -0.34304136, 0.4432264, 0.358757, -0.5097965, -0.3117462, 0.48591244, -0.23303306, -0.15626977, 0.35362205, 0.46103436, 0.31103745, 0.4197293, -0.26650566, -0.21247612, -0.064373255, 0.7373538, -0.042201377, 0.2346974, 0.06539949, -0.36871567, -0.22957169, -0.43013105, 0.33426255, -0.1984943},
    {-0.39336836, -0.35386518, -0.5329366, 0.38757324, 0.41068995, 0.50066906, 0.84830415, 0.58478296, -0.16722104, 0.029230952, 0.39251626, -0.1161414, 0.116292484, 0.39471513, -0.84678215, -0.15725377, 0.19627805, -0.84364575, -1.2078843, -0.7657867, 0.9665072, 0.88695455, 1.137792, -0.47198904, 0.36568108, -0.08891619, 0.839308, 0.49006703, -0.035265356, 0.14439379, -0.035195105, -0.4886831},
    {0.28235415, -0.0828507, 0.10534837, 0.014532179, -0.19118918, -0.32168669, -0.4013007, -0.2552888, 0.28942302, -0.5306306, -0.067617625, 0.4634209, 0.27792826, -0.03140985, 0.5882638, 0.054540325, -0.38590118, 0.5197031, 0.6939143, 0.33913314, -0.554995, -0.58178157, -0.55707246, 0.33086765, -0.09106307, -0.0013956914, -0.37943614, -0.092245005, 0.73143214, 0.17531332, 0.19183336, 0.779996},
    {-0.6713213, 0.48987198, 0.7702826, -0.8596576, -0.034616094, 0.22466026, -0.42711782, -0.61790085, -0.57955736, 0.4145116, 0.8055597, -0.19402976, -0.37801147, 0.70368207, 0.25524858, 0.3025528, 0.741864, 0.17141059, 0.046459563, 0.30792072, -0.23185235, -0.06093186, 0.09968914, 0.25312313, 0.20641357, 0.7805756, 0.23167306, -0.67510766, -0.6980217, -0.5669211, 0.33436093, -0.17600816},
    {0.5005221, 0.38145357, 0.04377742, -0.012284723, 0.020793026, -0.7982402, -0.3294046, 0.22585407, 0.34823337, -0.19806772, -0.552163, 0.29327634, -0.062406614, -0.55500644, 0.7790413, 0.27441433, -0.13602379, 0.3560676, 0.22644624, 0.43822142, -0.29475063, -0.377942, -0.4439098, -0.045221783, -0.25011122, -0.27707562, -0.6243439, -0.42667806, 0.81072015, 0.49151564, -0.20441562, 0.845151},
    {-0.122634545, 0.23592101, 0.37598515, -0.06318699, -0.111778475, -0.1321278, -0.33983943, 0.028524302, -0.35527644, 0.44173267, 0.5302337, -0.36953604, 0.044672545, 0.20083103, -0.07804314, 0.10228394, -0.02964454, 0.1296623, 0.033502765, 0.33561212, 0.4271059, -0.0883614, 0.16865717, 0.32135415, 0.29943368, -0.06725888, 0.39365473, 0.032168508, -0.0134256985, -0.16847326, 0.17681503, -0.028109694},
    {-0.44050506, 0.6632039, 0.6022506, -0.30590463, -0.21163307, -0.019306302, -0.49712446, -0.23209429, -0.22291419, 0.49700254, 0.02969286, -0.05913093, -0.13157123, 0.01509841, 0.3055331, 0.44179127, 0.3565421, -0.08116942, 0.48285112, 0.36755794, -0.30598617, -0.6677498, -0.10868831, 0.5757923, 0.35685188, 0.37564793, -0.4821544, -0.5489526, 0.05215714, -0.4084086, 0.7364974, 0.22628632},
    {0.18203473, -0.3817946, -0.25851917, 1.1123433, 0.5673734, 0.19583316, 0.58227813, 0.27975678, -0.09955513, 0.1321673, -0.27410078, -0.43369788, 0.9006265, 0.052607704, -0.57520556, -0.68064266, -0.15972771, -0.52641463, -0.9889523, -0.25979418, 1.08547, 0.9863436, 0.20421454, -0.42443356, -0.6355711, -0.74365455, 0.38872427, 0.593741, -0.123531654, 0.28124464, -0.9540666, -0.5305439},
    {-0.64573586, 0.105764195, 0.60818404, -0.15612184, -0.154691, 0.3128786, -0.23951256, -0.33499727, -0.21983695, 0.48294815, 0.511047, -0.23970632, -0.3163602, 0.19368003, 0.061124716, 0.18131699, 0.30162093, -0.14084384, -0.078559965, 0.40648255, 0.2520763, 0.0046755765, 0.5059504, 0.1952991, 0.3743854, 0.48497623, -0.06732629, -0.36011514, -0.47090605, -0.28493795, 0.27173185, -0.04921729},
    {0.052294046, 0.9984872, 0.5283175, -0.6639971, -0.61550343, -0.39380068, -0.5462548, -0.3514773, 0.21201497, 0.3019242, -0.09988417, 0.5594106, -0.62242407, 0.16763572, 0.38863215, 0.3952102, -0.02406008, 0.7585583, 0.7259689, 0.60845006, -0.7796847, -0.99099964, -0.3317299, 0.58166647, -0.25520015, 0.43545246, -0.69074726, -0.8386215, -0.14063251, -0.48047712, 0.25298378, 0.8243579},
};

	double biases_hidden_layer2[NUM_HIDDEN] = {0.17591986, -0.038911887, 0.023926094, 0.17507862, 0.0611726, -0.20056133, 0.057455957, 0.08470852, 0.16084291, 0.025623634, 0.05936741, 0.07141053, 0.18817148, -0.030140154, -0.035018872, -0.07247833, -0.047171053, -0.014444797, -0.10474735, -0.025942823, 0.047204033, 0.15987879, 0.097612515, 0.014402273, -0.065860495, -0.053704374, -0.007962659, 0.069686025, 0.15938438, 0.18926367, -0.124952614, -0.003936419};

	double weights_output_layer[NUM_HIDDEN][NUM_OUTPUTS] = {
    {0.10952865, 0.4390545, -0.47806266, -1.1747968},
    {-0.92811674, 0.30626863, 0.37718195, 0.04475184},
    {-0.88136333, 0.31359717, 0.25591496, 0.3968215},
    {0.5820985, 0.3239282, -1.143591, -0.76371294},
    {1.0091306, -0.22572862, -0.061651465, -0.011127455},
    {-0.38339168, -0.5306534, -0.22805905, 0.7418953},
    {0.84534824, -0.08806821, -0.54413116, -0.28049117},
    {0.8567465, -0.0019807273, -0.79925376, -0.842275},
    {0.43305913, 0.58492845, 0.3263756, -0.6374257},
    {-0.8486533, -0.64182377, -0.12251336, 0.9034999},
    {-0.16589819, -0.5129363, 0.1579877, 0.88872445},
    {0.37709352, 0.0029241713, 0.2988103, -0.95384103},
    {0.8891745, 0.6282254, -1.0764068, -0.7916134},
    {-0.43804175, -0.58759993, -0.043331467, 0.25183046},
    {0.009116726, 0.2372221, 0.6044056, -0.55596596},
    {-0.1035771, -0.34352297, 0.71599936, -0.42554072},
    {-0.2797478, -0.48936754, 0.65940183, 0.7737897},
    {-0.4211351, 0.55133706, 0.11182839, -0.4495998},
    {-0.8194143, 0.41656888, 0.6523722, -0.86900216},
    {-0.61203945, 0.23303299, -0.008676819, -0.17641349},
    {0.3867301, -0.050617933, -0.5616406, 0.48588368},
    {0.94574815, -0.2648858, -1.1343889, 0.23142001},
    {0.24215762, -0.60081017, -0.2643164, 0.95344037},
    {-0.82412165, 0.13830256, -0.072391994, 0.0912557},
    {-0.29838055, -0.47123158, 0.0900606, 0.06655954},
    {-0.7632227, -0.0643883, 0.504212, 0.44800892},
    {0.13405901, -0.5425735, -0.65120673, 0.6897425},
    {1.0379883, -0.46378514, -0.46180665, -0.52549636},
    {0.58635926, 0.5554855, 0.3291171, -0.5736986},
    {0.6984513, 0.18911012, -0.31929582, -1.0790998},
    {-1.0503093, -0.44371405, 0.74834824, 0.60046476},
    {-0.2803748, 0.1163228, 0.31853342, -0.7953149},
};
	double biases_output_layer[NUM_OUTPUTS] = {
-0.039379094, 0.08167318, 0.017540574, -0.14521462};

	// Compute values for hidden layer 1
	for(int i = 0; i < NUM_HIDDEN; i++){
		hidden_layer1[i] = 0;
		for(int j = 0; j < NUM_INPUTS; j++){
		    // std::cout << "dotting " << inputs[j] << "with " << weights_hidden_layer1[j][i] << "  " ;
			hidden_layer1[i] += inputs[j] * weights_hidden_layer1[j][i];
		}
		// std::cout << hidden_layer1[i] << " ";
		hidden_layer1[i] += biases_hidden_layer1[i];
		hidden_layer1[i] = sigmoid(hidden_layer1[i]);
	}

	// Compute values for hidden layer 2
	for(int i = 0; i < NUM_HIDDEN; i++){
		hidden_layer2[i] = 0;
		for(int j = 0; j < NUM_HIDDEN; j++){
		    hidden_layer2[i] += hidden_layer1[j] * weights_hidden_layer2[j][i];
		}
		hidden_layer2[i] += biases_hidden_layer2[i];
		hidden_layer2[i] = sigmoid(hidden_layer2[i]);
	}

	// softmax implementation
	double offset = outputs[0];
	double sum = 0.0;


	// Compute values for output layer
	for(int i = 0; i < NUM_OUTPUTS; i++){
		outputs[i] = 0;
		for(int j = 0; j < NUM_HIDDEN; j++){
			outputs[i] += hidden_layer2[j] * weights_output_layer[j][i];
		}
		outputs[i] += biases_output_layer[i];
	}

	// Compute the exponential of each input
	for (int i = 0; i < NUM_OUTPUTS; i++) {
		softmax_outputs[i] = exp(outputs[i]-offset);
		sum += softmax_outputs[i];
	}

	// Normalize the outputs by the sum of exponentials
	for (int i = 0; i < NUM_OUTPUTS; i++) {
		softmax_outputs[i] /= sum;
	}

	double max = softmax_outputs[0];
	int ans = 0;	 

	for (int i = 0; i < NUM_OUTPUTS; i++) {
        if (softmax_outputs[i] > max) {
            ans = i;
        }
    }

    return ans;
}

int main() {
    double inputs[INPUT_SAMPLES][NUM_INPUTS] = {
    {1.0, 0.5477681232101705, 0.18317971259004384, 0.05660341105706834, 0.0, 0.03368779909594455, 0.0, 0.04825030213901993, 0.0, 0.7168105747559064, 0.3258688540972252, 0.8616751066883992, 0.6268355504231142, 1.0, 0.6525261621028474, 0.566940343374764, 0.5257616328015855, 0.6800020835058022, 0.7168105747559064, 0.3258688540972252, 0.8616751066883992, 0.8845195066271776, 0.9314931861394465, 0.3030071001548842},
    {0.9014613856009106, 0.0, 0.10140225623084209, 0.050021663757352286, 0.192403067611572, 0.03039165704911806, 0.14636793016974892, 0.04093864766161648, 0.0888263437924639, 0.7366205017391096, 0.32712252046861945, 0.8562906620720991, 0.9868659218754459, 0.05095614712022825, 0.15479233840800777, 0.44716166712825434, 0.801161102716055, 0.5894399549466363, 0.7366205017391096, 0.32712252046861945, 0.8562906620720991, 0.5144555007159992, 0.9921044395143027, 0.11644877980899893},
    {0.7373375381083456, 0.918156938630809, 1.0000000000000002, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.8574846170748938, 0.10572575923203664, 1.0000000000000002, 0.23952755461489264, 0.0, 1.0, 1.0, 0.0, 0.0, 0.8574846170748938, 0.10572575923203664, 0.0, 0.0, 0.9999999999999999},
    {0.0, 1.0, 0.0, 0.6194139929619205, 0.4684127883167317, 0.5655525408721296, 0.6589559803765859, 0.5767638806435578, 0.5245908077379138, 1.0, 0.0, 0.0, 0.0, 0.9504938424510768, 0.9999999999999999, 0.0, 0.0, 0.9999999999999999, 1.0, 0.0, 0.0, 0.2842168781586283, 0.9999999999999999, 0.0},
    {0.7593768128463694, 0.3259207124825474, 0.26901245004614793, 0.0, 0.1075601254929559, 0.0, 0.06975939513060325, 0.0, 0.060718111388904816, 0.5098568449020378, 1.0, 1.0000000000000002, 0.9925211745466718, 0.0, 0.03354686034195007, 0.29436588633565375, 0.6139900491819568, 0.3197788528406462, 0.5098568449020378, 1.0, 1.0000000000000002, 1.0000000000000004, 0.9302490492843026, 0.16132240364027262},
};
    // print mlp(inputs)
    for (int i = 0; i < INPUT_SAMPLES; i++) {
        std::cout << mlp(inputs[i]) << std::endl;
    }

    return 0;
}
